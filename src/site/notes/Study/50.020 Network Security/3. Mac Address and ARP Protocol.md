---
{"tags":["#lesson","Security"],"week":1,"creation date":"2023-10-19 20:14","modification date":"Thursday 19th October 2023 20:14:24","reviewed":null,"summary":null,"course_name":"Network Security","publish":true,"dg-publish":true,"permalink":"/study/50-020-network-security/3-mac-address-and-arp-protocol/","dgPassFrontmatter":true,"created":"2023-10-19T20:14:24.050+08:00","updated":"2023-10-31T00:11:16.711+08:00"}
---


# Network Interfaces
`Network interface` is a device connecting a computer to a network
`MAC` address is associated with each `network interfaces`
`Packets` are transmitted between network interfaces
Most LAN broadcast frames
each network interface gets the frames intended for it
`traffic sniffing` can be accomplished by configuring the network interface to read all frames

# Mac Address
- A MAC address is a 48-bit number usually represented in hex
- First 3 Octets of any MAC address are IEEE-assigned Organizational Unique Identifiers
	- each organization has a different Octets
- The next three can be assigned by organizations as they please, with uniqueness being the only constraint
- Organizations can utilize MAC addresses to identify computers on their network
- MAC address can be reconfigured by network interface driver software
## Switch
Operates at the link layer, it has multiple ports and connected to computers
It learns the `MAC` address of each computer connected to it
Forward frames only to the destination computer
## Combining switches
- Switches can be arrange into a `tree`
- Each port learns the MAC address of the machines in the subtree
- Fragments to unknown addresses are broadcast
- Frames to MAC addresses in the same segments as the sender are ignored

## MAC Address Filtering
A switch can be configured to provide service to machines with specific MAC addresses, only allow MAC addresses need to be registered with a network administrator
## MAC Spoofing attack
- Find out MAC address of target machine
- Reconfigure MAC address of rogue machine
- Turn off or unplug target machine

## Viewing and Changing MAC Addresses
- Changing a MAC address in Linux
	- Stop the networking service: `/etc/init.d/network stop`
	- Change the MAC address:` ifconfig eth0 hw ether <MAC-address>
	- Start the networking service: `/etc/init.d/network start`

# ARP
The` address resolution protocol (ARP)` connects the network layer to the data layer by converting `IP` addresses to `MAC` addresses
ARP works by broadcasting requests and caching responses for future use
Each devices has a ARP table that contains mapping of IP to physical MAC Address
## ARP Spoofing
It assumes that machines trust each other
requests are not tracked and ARP announcements are not authenticated
Malicious machine can claim that the their MAC address has this IP address and in the future the malicious machine can receive everything that is intended for the target machine
<style> .container {font-family: sans-serif; text-align: center;} .button-wrapper button {z-index: 1;height: 40px; width: 100px; margin: 10px;padding: 5px;} .excalidraw .App-menu_top .buttonList { display: flex;} .excalidraw-wrapper { height: 800px; margin: 50px; position: relative;} :root[dir="ltr"] .excalidraw .layer-ui__wrapper .zen-mode-transition.App-menu_bottom--transition-left {transform: none;} </style><script src="https://cdn.jsdelivr.net/npm/react@17/umd/react.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/react-dom@17/umd/react-dom.production.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@excalidraw/excalidraw@0/dist/excalidraw.production.min.js"></script><div id="Wk_-_1_2023-09-12_1332.24.excalidraw.md1"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://github.com/zsviczian/obsidian-excalidraw-plugin/releases/tag/1.9.19","elements":[{"type":"rectangle","version":83,"versionNonce":2085609746,"isDeleted":false,"id":"V4TgHTddyVq96fm1rJz7Z","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-276.07421875,"y":-258.65234375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":134,"height":74,"seed":269517138,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"8I5LAmLv"},{"id":"SCkTSM73EaaAndzJXA1lP","type":"arrow"},{"id":"jzBd-88y4DenoDEmz0ShG","type":"arrow"},{"id":"0nxkpvco8Hj-2dFBM7cbM","type":"arrow"}],"updated":1694505851359,"link":null,"locked":false},{"type":"text","version":19,"versionNonce":99348814,"isDeleted":false,"id":"8I5LAmLv","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-236.1241912841797,"y":-234.15234375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":54.099945068359375,"height":25,"seed":1112461202,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1694496798846,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Client","rawText":"Client","textAlign":"center","verticalAlign":"middle","containerId":"V4TgHTddyVq96fm1rJz7Z","originalText":"Client","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":146,"versionNonce":526885518,"isDeleted":false,"id":"jmVWMDwrtzfVvX59Ghr5c","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":241.638671875,"y":-258.2734375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":129,"height":72,"seed":605979602,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"6cSxK8qp"},{"id":"SCkTSM73EaaAndzJXA1lP","type":"arrow"},{"id":"qBEbGudb67hY0MUAS3VKa","type":"arrow"},{"id":"B2LcGecOYG8OYusmncrQ7","type":"arrow"}],"updated":1694505874907,"link":null,"locked":false},{"type":"text","version":7,"versionNonce":419302350,"isDeleted":false,"id":"6cSxK8qp","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":275.93870544433594,"y":-234.7734375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":60.399932861328125,"height":25,"seed":552899090,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1694496809495,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"server","rawText":"server","textAlign":"center","verticalAlign":"middle","containerId":"jmVWMDwrtzfVvX59Ghr5c","originalText":"server","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":121,"versionNonce":777274514,"isDeleted":false,"id":"w041S3R7jqJFwJsR-jjr3","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-12.873046875,"y":-219.7734375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":132,"height":35,"seed":1212462734,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"Q2u0Jr8L"},{"id":"0nxkpvco8Hj-2dFBM7cbM","type":"arrow"}],"updated":1694505851359,"link":null,"locked":false},{"type":"text","version":15,"versionNonce":1320247886,"isDeleted":false,"id":"Q2u0Jr8L","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":23.806983947753906,"y":-214.7734375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":58.63993835449219,"height":25,"seed":820876690,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1694496818167,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"switch","rawText":"switch","textAlign":"center","verticalAlign":"middle","containerId":"w041S3R7jqJFwJsR-jjr3","originalText":"switch","lineHeight":1.25,"baseline":18},{"type":"arrow","version":90,"versionNonce":859287698,"isDeleted":false,"id":"SCkTSM73EaaAndzJXA1lP","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-134.0859375,"y":-240.72265625,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":368.0078125,"height":4.5625,"seed":2085684174,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1694505817282,"link":null,"locked":false,"startBinding":{"elementId":"V4TgHTddyVq96fm1rJz7Z","gap":7.98828125,"focus":-0.5286719157281681},"endBinding":{"elementId":"jmVWMDwrtzfVvX59Ghr5c","gap":7.716796875,"focus":0.3530300749395136},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[368.0078125,4.5625]]},{"type":"line","version":116,"versionNonce":1237245710,"isDeleted":false,"id":"1GIoKs2_wwx91yspiq3at","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-140.0703125,"y":-201.06640625,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":126.66015625,"height":1.8828125,"seed":1138428818,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1694496846520,"link":null,"locked":false,"startBinding":null,"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":null,"points":[[0,0],[126.66015625,1.8828125]]},{"type":"line","version":86,"versionNonce":145500562,"isDeleted":false,"id":"dpD4LpC7VfRn3PF0ALDaQ","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":119.03515625,"y":-196.26171875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":124.30078125,"height":1.25390625,"seed":619433294,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1694496851506,"link":null,"locked":false,"startBinding":null,"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":null,"points":[[0,0],[124.30078125,-1.25390625]]},{"type":"rectangle","version":131,"versionNonce":366300686,"isDeleted":false,"id":"yrEROwLPn0Uwo119zRcIN","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-59.02734375,"y":128.951171875,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":222,"height":104,"seed":812723918,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"ozCHx2Cw"},{"id":"qBEbGudb67hY0MUAS3VKa","type":"arrow"},{"id":"jzBd-88y4DenoDEmz0ShG","type":"arrow"},{"id":"0nxkpvco8Hj-2dFBM7cbM","type":"arrow"},{"id":"B2LcGecOYG8OYusmncrQ7","type":"arrow"}],"updated":1694505874907,"link":null,"locked":false},{"type":"text","version":12,"versionNonce":893413586,"isDeleted":false,"id":"ozCHx2Cw","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":14.902687072753906,"y":168.451171875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":74.13993835449219,"height":25,"seed":938785806,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1694496862406,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Cracker","rawText":"Cracker","textAlign":"center","verticalAlign":"middle","containerId":"yrEROwLPn0Uwo119zRcIN","originalText":"Cracker","lineHeight":1.25,"baseline":18},{"type":"line","version":156,"versionNonce":211255506,"isDeleted":false,"id":"Z0JIhLjfw25F7bcxmjyIs","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":51.0546875,"y":-180.33203125,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":2.203125,"height":309.38671875,"seed":76133518,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1694496875496,"link":null,"locked":false,"startBinding":null,"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":null,"points":[[0,0],[2.203125,309.38671875]]},{"type":"arrow","version":85,"versionNonce":150591378,"isDeleted":false,"id":"qBEbGudb67hY0MUAS3VKa","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":123.0625,"y":122.015625,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":160.26171875,"height":302.015625,"seed":1837560914,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[{"type":"text","id":"lSpvZdVO"}],"updated":1694505817284,"link":null,"locked":false,"startBinding":{"elementId":"yrEROwLPn0Uwo119zRcIN","gap":6.935546875,"focus":0.28728845350225796},"endBinding":{"elementId":"jmVWMDwrtzfVvX59Ghr5c","gap":6.2734375,"focus":0.004574660488928122},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[160.26171875,-302.015625]]},{"type":"text","version":61,"versionNonce":1583566030,"isDeleted":false,"id":"lSpvZdVO","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":132.03341674804688,"y":-66.4921875,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":142.31988525390625,"height":75,"seed":1589224082,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1694496917479,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"ARP reply\nClient's IP -> \nCracker's Mac","rawText":"ARP reply\nClient's IP -> Cracker's Mac","textAlign":"center","verticalAlign":"middle","containerId":"qBEbGudb67hY0MUAS3VKa","originalText":"ARP reply\nClient's IP -> Cracker's Mac","lineHeight":1.25,"baseline":68},{"type":"arrow","version":227,"versionNonce":849031054,"isDeleted":false,"id":"jzBd-88y4DenoDEmz0ShG","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-57.22575597294113,"y":120.38105925208228,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":94.16383272058823,"height":299.8327205882353,"seed":1341833298,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[{"type":"text","id":"nutZN3xo"}],"updated":1694505823200,"link":null,"locked":false,"startBinding":{"elementId":"yrEROwLPn0Uwo119zRcIN","focus":-0.7082030899128342,"gap":8.57011262291772},"endBinding":{"elementId":"V4TgHTddyVq96fm1rJz7Z","focus":-0.5651399493477189,"gap":5.200682413846977},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-94.16383272058823,-299.8327205882353]]},{"type":"text","version":73,"versionNonce":676613138,"isDeleted":false,"id":"nutZN3xo","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-179.26761038255165,"y":-67.03530104203537,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":149.9198760986328,"height":75,"seed":2132993554,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1694505827759,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"ARP reply\nServer's IP -> \nCracker's Mac","rawText":"ARP reply\nServer's IP -> Cracker's Mac","textAlign":"center","verticalAlign":"middle","containerId":"jzBd-88y4DenoDEmz0ShG","originalText":"ARP reply\nServer's IP -> Cracker's Mac","lineHeight":1.25,"baseline":68},{"id":"0nxkpvco8Hj-2dFBM7cbM","type":"arrow","x":-130.13964843749997,"y":-176.9958065257353,"width":150.3308823529412,"height":292.15073529411757,"angle":0,"strokeColor":"#e03131","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":2},"seed":460178510,"version":671,"versionNonce":1465932494,"isDeleted":false,"boundElements":[{"type":"text","id":"Et1iIJ8e"}],"updated":1694505892554,"link":null,"locked":false,"points":[[0,0],[146.70496323529412,23.961397058823536],[150.3308823529412,292.15073529411757]],"lastCommittedPoint":null,"startBinding":{"elementId":"V4TgHTddyVq96fm1rJz7Z","focus":0.6625371291141764,"gap":11.934570312500028},"endBinding":{"elementId":"yrEROwLPn0Uwo119zRcIN","focus":-0.2765534165191786,"gap":13.796243106617752},"startArrowhead":null,"endArrowhead":"arrow"},{"id":"Et1iIJ8e","type":"text","x":-50.744621725643356,"y":-165.53440946691177,"width":134.619873046875,"height":25,"angle":0,"strokeColor":"#e03131","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":1860254546,"version":19,"versionNonce":1479641486,"isDeleted":false,"boundElements":null,"updated":1694505905873,"link":null,"locked":false,"text":"ARP poisioning","rawText":"ARP poisioning","fontSize":20,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":18,"containerId":"0nxkpvco8Hj-2dFBM7cbM","originalText":"ARP poisioning","lineHeight":1.25},{"id":"B2LcGecOYG8OYusmncrQ7","type":"arrow","x":79.56163832720586,"y":110.72478170955878,"width":160.81801470588232,"height":293.9292279411764,"angle":0,"strokeColor":"#e03131","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":2},"seed":1068360722,"version":353,"versionNonce":1872038542,"isDeleted":false,"boundElements":null,"updated":1694505886762,"link":null,"locked":false,"points":[[0,0],[8.198529411764753,-268.90624999999994],[160.81801470588232,-293.9292279411764]],"lastCommittedPoint":null,"startBinding":{"elementId":"yrEROwLPn0Uwo119zRcIN","focus":0.22603188386244732,"gap":18.226390165441217},"endBinding":{"elementId":"jmVWMDwrtzfVvX59Ghr5c","focus":-0.6073481497183754,"gap":3.0689912683823763},"startArrowhead":null,"endArrowhead":"arrow"}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#e03131","currentItemBackgroundColor":"#ffc9c9","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":312.1295381433823,"scrollY":601.3478285845588,"zoom":{"value":0.8500000000000001},"currentItemRoundness":"round","gridSize":null,"gridColor":{"Bold":"#C9C9C9FF","Regular":"#EDEDEDFF"},"currentStrokeOptions":null,"previousGridSize":null,"frameRendering":{"enabled":true,"clip":true,"name":true,"outline":true}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Wk_-_1_2023-09-12_1332.24.excalidraw.md1");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

# Packet Sniffing and Spoofing
- Packets are received through Network Interface Card (NIC)'s MAC address
- NIC checks the destination address for every packet, if the  address matches the cards MAC address, it is further copied into buffer in the kernel

## Promiscuous Mode
- The frames that are not destined to a given NIC are discarded
- When operating in `promiscuous mode`, NIC passes `every frame` received from network to kernel
- If a sniffer program is registered with the kernel, it will be able to see all the packets

## BSD Packet Filter (BPF)
BPF allow a user program to attach a filter to the socket which tells the kernel to discard unwanted packets
- Predefine a list of unwanted prefix of the code
- filter out those code
<div id="Network_Security_Wk_-_2_2023-09-18_0924.32.excalidraw.md2"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://github.com/zsviczian/obsidian-excalidraw-plugin/releases/tag/1.9.19","elements":[{"type":"line","version":255,"versionNonce":39187598,"isDeleted":false,"id":"4poSdC7ZHrlabhYRF3pWd","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-337.6409801136364,"y":-128.57705965909093,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":525.0120738636361,"height":0.40518465909093493,"seed":504740529,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000503968,"link":null,"locked":false,"startBinding":null,"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":null,"points":[[0,0],[525.0120738636361,0.40518465909093493]]},{"type":"text","version":8,"versionNonce":1083328465,"isDeleted":false,"id":"ZxeuJyLw","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-274,"y":-153.5546875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":76.71992492675781,"height":25,"seed":1107790015,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000285633,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Network","rawText":"Network","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Network","lineHeight":1.25,"baseline":18},{"type":"text","version":41,"versionNonce":1979717439,"isDeleted":false,"id":"bZfH0tpn","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-269.64453125,"y":-115.6953125,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":57.33995056152344,"height":25,"seed":515470847,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000291307,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Kernel","rawText":"Kernel","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Kernel","lineHeight":1.25,"baseline":18},{"type":"arrow","version":200,"versionNonce":642990478,"isDeleted":false,"id":"8axT_tql86-4aNK2lMFbI","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-159.28125,"y":-152.0625,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":1.351167043359709,"height":72.6484375,"seed":1751421823,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499319,"link":null,"locked":false,"startBinding":null,"endBinding":{"elementId":"3jcrYX4IKvRUMoTmtEO0o","gap":4.15234375,"focus":0.016602218647872247},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[1.351167043359709,72.6484375]]},{"type":"rectangle","version":291,"versionNonce":1186715185,"isDeleted":false,"id":"3jcrYX4IKvRUMoTmtEO0o","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-222.875,"y":-75.26171875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":129,"height":60,"seed":1210001681,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"oTQK5M5p"},{"id":"8axT_tql86-4aNK2lMFbI","type":"arrow"},{"id":"UJTH9q_lF7DeobabA4nQr","type":"arrow"}],"updated":1695000323808,"link":null,"locked":false},{"type":"text","version":308,"versionNonce":762633265,"isDeleted":false,"id":"oTQK5M5p","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-212.2749481201172,"y":-57.76171875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":107.79989624023438,"height":25,"seed":1610974385,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000315536,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Ring buffer","rawText":"Ring buffer","textAlign":"center","verticalAlign":"middle","containerId":"3jcrYX4IKvRUMoTmtEO0o","originalText":"Ring buffer","lineHeight":1.25,"baseline":18},{"type":"arrow","version":48,"versionNonce":1708122062,"isDeleted":false,"id":"UJTH9q_lF7DeobabA4nQr","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-160.5625,"y":-8.08203125,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":2.3671875,"height":50.4296875,"seed":2009919391,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499319,"link":null,"locked":false,"startBinding":{"elementId":"3jcrYX4IKvRUMoTmtEO0o","gap":7.1796875,"focus":0.006710426766563832},"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-2.3671875,50.4296875]]},{"type":"rectangle","version":85,"versionNonce":1547442623,"isDeleted":false,"id":"JBSXpyv2ADkhz1uwrBGXv","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-224.248046875,"y":43.015625,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":132,"height":60,"seed":35907601,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"1c3rYKOT"},{"id":"V_i29hDttaLeP3mMHn5VO","type":"arrow"}],"updated":1695000344661,"link":null,"locked":false},{"type":"text","version":19,"versionNonce":1337556543,"isDeleted":false,"id":"1c3rYKOT","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-198.14800262451172,"y":48.015625,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":79.79991149902344,"height":50,"seed":837848529,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000333935,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"link-level\ndriver","rawText":"link-level\ndriver","textAlign":"center","verticalAlign":"middle","containerId":"JBSXpyv2ADkhz1uwrBGXv","originalText":"link-level\ndriver","lineHeight":1.25,"baseline":43},{"type":"arrow","version":280,"versionNonce":2142815310,"isDeleted":false,"id":"V_i29hDttaLeP3mMHn5VO","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-159.01117338824483,"y":111.05859375000003,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":0.036316430147905976,"height":51.66796874999997,"seed":1622977233,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499320,"link":null,"locked":false,"startBinding":{"elementId":"JBSXpyv2ADkhz1uwrBGXv","gap":8.04296875,"focus":0.012162642045454546},"endBinding":{"elementId":"b4YttKjgr1yq5-xpB0naK","gap":1.05078125,"focus":-0.11938479867861689},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[0.036316430147905976,51.66796874999997]]},{"type":"rectangle","version":409,"versionNonce":923944927,"isDeleted":false,"id":"b4YttKjgr1yq5-xpB0naK","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-285.96484375,"y":163.77734375,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":288.5234375,"height":122.87109375,"seed":774932959,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"id":"V_i29hDttaLeP3mMHn5VO","type":"arrow"},{"id":"hXEvL6ZbRXbyQ-O4Lj0NH","type":"arrow"},{"id":"5j8FTeIs3aSrZO-bTeRTb","type":"arrow"}],"updated":1695000420652,"link":null,"locked":false},{"type":"rectangle","version":108,"versionNonce":1659206097,"isDeleted":false,"id":"aUImR1FhUY6piZEzosvb3","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-256.318359375,"y":200.33203125,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":114,"height":46,"seed":312054143,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"2Lxvd1MS"},{"id":"lTTlX9MYeDsTITD1iXq69","type":"arrow"},{"id":"hXEvL6ZbRXbyQ-O4Lj0NH","type":"arrow"}],"updated":1695000415140,"link":null,"locked":false},{"type":"text","version":7,"versionNonce":615250929,"isDeleted":false,"id":"2Lxvd1MS","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-224.41832733154297,"y":210.83203125,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":50.19993591308594,"height":25,"seed":535725727,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000390267,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"filter","rawText":"filter","textAlign":"center","verticalAlign":"middle","containerId":"aUImR1FhUY6piZEzosvb3","originalText":"filter","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":158,"versionNonce":1024287647,"isDeleted":false,"id":"6NAkF181uWjRdKrxdsQnc","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-126.8125,"y":202.140625,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":114,"height":46,"seed":1839856497,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"kEnSSobG"},{"id":"A3-QqPWBxnawHZawfojxj","type":"arrow"},{"id":"5j8FTeIs3aSrZO-bTeRTb","type":"arrow"}],"updated":1695000420652,"link":null,"locked":false},{"type":"text","version":57,"versionNonce":1288890513,"isDeleted":false,"id":"kEnSSobG","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-94.91246795654297,"y":212.640625,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":50.19993591308594,"height":25,"seed":177956177,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000394554,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"filter","rawText":"filter","textAlign":"center","verticalAlign":"middle","containerId":"6NAkF181uWjRdKrxdsQnc","originalText":"filter","lineHeight":1.25,"baseline":18},{"type":"arrow","version":84,"versionNonce":1693911694,"isDeleted":false,"id":"lTTlX9MYeDsTITD1iXq69","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-155.265625,"y":164.84765625,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":32.75685649555328,"height":34.484375,"seed":411897919,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499321,"link":null,"locked":false,"startBinding":null,"endBinding":{"elementId":"aUImR1FhUY6piZEzosvb3","gap":1,"focus":-0.14587376845807068},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-32.75685649555328,34.484375]]},{"type":"arrow","version":85,"versionNonce":1428499790,"isDeleted":false,"id":"A3-QqPWBxnawHZawfojxj","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-156.90234375,"y":164.5859375,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":61.71475338676454,"height":36.5546875,"seed":1286123217,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499322,"link":null,"locked":false,"startBinding":null,"endBinding":{"elementId":"6NAkF181uWjRdKrxdsQnc","gap":1,"focus":0.15802644928424828},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[61.71475338676454,36.5546875]]},{"type":"arrow","version":87,"versionNonce":1571045134,"isDeleted":false,"id":"hXEvL6ZbRXbyQ-O4Lj0NH","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-202.23828125000003,"y":250.18359375000006,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":47.80859375000506,"height":40.18359374999994,"seed":1740830015,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499321,"link":null,"locked":false,"startBinding":{"elementId":"aUImR1FhUY6piZEzosvb3","gap":3.8515625,"focus":0.4132868929472459},"endBinding":{"elementId":"b4YttKjgr1yq5-xpB0naK","gap":3.71875,"focus":-0.41519260662006835},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[47.80859375000506,40.18359374999994]]},{"type":"arrow","version":128,"versionNonce":1631105486,"isDeleted":false,"id":"5j8FTeIs3aSrZO-bTeRTb","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-78.00781249999999,"y":252.26953125,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":76.26171874999433,"height":35.43359375,"seed":4759409,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499322,"link":null,"locked":false,"startBinding":{"elementId":"6NAkF181uWjRdKrxdsQnc","gap":4.12890625,"focus":-0.4712858584948285},"endBinding":{"elementId":"b4YttKjgr1yq5-xpB0naK","gap":1.0546875,"focus":0.440990872468086},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-76.26171874999433,35.43359375]]},{"type":"arrow","version":138,"versionNonce":991774734,"isDeleted":false,"id":"0vk1NbzE7oIu6jszt8G8g","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-153.421875,"y":285.61328125,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":0.3590699176607757,"height":98.55468750000006,"seed":1180431359,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499323,"link":null,"locked":false,"startBinding":null,"endBinding":{"elementId":"Crnfwcur1Xkuo9OwCmI83","gap":9.44921875,"focus":-0.1012367462993192},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[0.3590699176607757,98.55468750000006]]},{"type":"rectangle","version":94,"versionNonce":1668668913,"isDeleted":false,"id":"Crnfwcur1Xkuo9OwCmI83","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-288.09765625,"y":393.6171875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":301,"height":97,"seed":1996339409,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"id":"0vk1NbzE7oIu6jszt8G8g","type":"arrow"},{"type":"text","id":"AnRainSM"},{"id":"FKQYsJEFOITZT9IM8k5Ng","type":"arrow"}],"updated":1695000477488,"link":null,"locked":false},{"type":"text","version":16,"versionNonce":2132360703,"isDeleted":false,"id":"AnRainSM","fillStyle":"solid","strokeWidth":1,"strokeStyle":"dashed","roughness":1,"opacity":100,"angle":0,"x":-211.71759033203125,"y":429.6171875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":148.2398681640625,"height":25,"seed":548516593,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000456674,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Protocol Stack","rawText":"Protocol Stack","textAlign":"center","verticalAlign":"middle","containerId":"Crnfwcur1Xkuo9OwCmI83","originalText":"Protocol Stack","lineHeight":1.25,"baseline":18},{"type":"line","version":88,"versionNonce":863422079,"isDeleted":false,"id":"NDnLiFmucERAMZmHNrAjz","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-355.11328125,"y":520.96484375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":605.625,"height":6.86328125,"seed":1235763967,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000460202,"link":null,"locked":false,"startBinding":null,"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":null,"points":[[0,0],[605.625,6.86328125]]},{"type":"text","version":7,"versionNonce":1901444561,"isDeleted":false,"id":"bLTYhZQe","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-435,"y":481.4453125,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":57.33995056152344,"height":25,"seed":1441383135,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000465733,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Kernel","rawText":"Kernel","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"Kernel","lineHeight":1.25,"baseline":18},{"type":"text","version":13,"versionNonce":2040869279,"isDeleted":false,"id":"56TxxSt1","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-427,"y":550.4453125,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":44.679962158203125,"height":25,"seed":468673393,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695000472440,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"User","rawText":"User","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"User","lineHeight":1.25,"baseline":18},{"type":"arrow","version":77,"versionNonce":278206030,"isDeleted":false,"id":"FKQYsJEFOITZT9IM8k5Ng","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-137.76171875,"y":492.859375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":0.2578125,"height":92.75390625,"seed":244225503,"groupIds":[],"frameId":null,"roundness":{"type":2},"boundElements":[],"updated":1695000499323,"link":null,"locked":false,"startBinding":{"elementId":"Crnfwcur1Xkuo9OwCmI83","gap":2.2421875,"focus":0.00015283943630430745},"endBinding":null,"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-0.2578125,92.75390625]]}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#1e1e1e","currentItemBackgroundColor":"transparent","currentItemFillStyle":"solid","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":449.2015591087492,"scrollY":390.98210106710434,"zoom":{"value":1.1},"currentItemRoundness":"round","gridSize":null,"gridColor":{"Bold":"#C9C9C9FF","Regular":"#EDEDEDFF"},"currentStrokeOptions":null,"previousGridSize":null,"frameRendering":{"enabled":true,"clip":true,"name":true,"outline":true}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Network_Security_Wk_-_2_2023-09-18_0924.32.excalidraw.md2");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

## Packet Sniffing
Packet sniffing describes the process of capturing live data as they flow across a network
### Receiving Packets Using Sockets
- Create the socket
- Provide information about server
- Receive packets
![Pasted image 20230918093115.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918093115.png)
### Receiving Packets Using Raw Sockets
![Pasted image 20230918093433.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918093433.png)
### Limitation
- Not portable across different operating systems
- setting filters is not easy
- program does not explore optimization to improve performance
- PCAP(packet capture) library
	- uses raw sockets internally
	- API is standard across all platforms
	- allow programmers to specify filtering rules using human readable boolean expressions
## Packets Sniffing Using PCAP API
![Pasted image 20230918093955.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918093955.png)
`pcap_compile` makes this code usable on multiple OS

### Processing captured packets
Type Cast the Ethernet header to check if that is the intended protocol
![Pasted image 20230918094628.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918094628.png)


#### IP Header
Strip off the ethernet header
typecast the IP header
You need to start at the correct byte for the typecast to work
![Pasted image 20230918094755.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918094755.png)
Check the IP header for the `protocol` that you want be it `TCP` or `UDP`, etc

#### Further Processing
If we want to further process the packet, we use similar techinique
- calculate the correct header length
- type cast it

## Packet Spoofing
When some critical information in the packet is forged, we refer to it as packet spoofing
Many network attacks rely on packet spoofing

### Sending Packets without Spoofing

![Pasted image 20230918095352.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918095352.png)
`nc`-> netcat
`l`-> listening
`u`-> local mode
`v`-> verbose
### Spoofing Packets Using Raw Sockets
- Constructing the packet
- Sending the packet out
![Pasted image 20230918095626.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918095626.png)
You will want to set the packet header instead of letting the OS decide on the packets header
Since it is a `raw socket` the system will send out the IP Packets as it is
#### Spoofing Packet: Constructing the Packet
![Pasted image 20230918100155.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918100155.png)
We can fill in the source IP address as anything we want instead of the actual IP address of our system
![Pasted image 20230918100348.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918100348.png)
#### Spoofing UDP Packets
![Pasted image 20230918100442.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918100442.png)
![Pasted image 20230918100603.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918100603.png)
`1.2.3.4` is what is coded into the udp packet
## Sniffing and then Spoofing
We Sniff the packet first and gain the relevant information and spoof the packet using these information that we get and replace the packet information with what we want to send
![Pasted image 20230918101101.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918101101.png)
![Pasted image 20230918101108.png](/img/user/Study/Leet%20Code/attachments/Pasted%20image%2020230918101108.png)
#### Packet Sniffing Using Scapy
```python
from scapy.all import *

print("SNIFFING PACKETS")
def print_pkt(pkt):
	print("Source IP:",pkt[IP].src)
	print("Destination IP:",pkt[IP].dst)
	print("Protocol",pkt[IP].proto)
pkt = sniff(filter='icmp',prn=print_pkt)
```
`prn` is a call back function that is called when the packet matches the filter is found
#### Spoofing ICMP & UDP Using Scapy
```python
from scapy.all import *

print("SENDING SPOOFED ICMP PACKET ...")
# Constructing a IP header
ip = IP(src='1.2.3.4',dst='93.184.216.34')
# Constructing ICMP info
icmp = ICMP()
pkt = ip/icmp
pkt.show()
send(pkt,verbose=0)
```
```python
from scapy.all import *

print("SENDING SPOOFED UDP PACKET")
# Constructing a IP header
ip = IP(src='1.2.3.4',dst='10.0.2.69')
# UDP Layer
# sport -> source port
# dport -> destination port
udp = UDP(sport=8888,dport=9090)

data = 'Hello UDP!\n'
# Constructing packet
pkt = ip/udp/data
pkt.show()
send(pkt,verbose=0)

```
#### Sniffing and then Spoofing Using Scapy
```python
from scapy.all import *
def spoof_pkt(pkt):
	if ICMP in pkt and pkt[ICMP].type == 8:
		print("Original Packet ...")
		print("Source IP:", pkt[IP].src)
		print("Destination IP:",pkt[IP].dst)
		ip = IP(src=pkt[IP].dst,dst=pkt[IP].src,ihl=pkt[IP].ihl)
		icmp = ICMP(type=0,id=pkt[ICMP].id,seq=pkt[ICMP].seq)
		data = pkt[Raw].load
		newpkt = ip/icmp/data
		print("spoofed Packet...")
		print("Source IP:", newpkt[IP].src)
		print("Destination IP:",newpkt[IP].dst)
		send(newpkt,verbose=0)
pkt = sniff(filter='icmp and src host 10.0.2.69', prn=spoof_pkt)
```
- `if ICMP in pkt and pkt[ICMP].type == 8:` 
	- checks for the protocol if it is `ICMP` and is it `type 8` which is `echo` request
- `ip = IP(src=pkt[IP].dst, dst=pkt[IP].src, ihl=pkt[IP].ihl)`
	- A new IP header is created, swapping the source and destination IP addresses. The Internet Header Length (`ihl`) is copied from the original packet.
- `icmp = ICMP(type=0, id=pkt[ICMP].id, seq=pkt[ICMP].seq)`
	- A new ICMP header is created with a type of 0 (which represents an `ICMP echo reply`), and the ID and sequence numbers are copied from the original packet. 
- `data = pkt[Raw].load`
	- The payload (or data) of the original packet is copied.
- `pkt = sniff(filter='icmp and src host 10.0.2.69', prn=spoof_pkt)`
	- The script sniffs incoming ICMP packets with a source IP address of 10.0.2.69 and passes them to the `spoof_pkt` function for spoofing.
This script is to intercept ICMP echo request packets (often known as "ping" packets) and respond to them with a spoofed ICMP echo reply. Essentially, the script acts as if it's the intended destination of the original ICMP request by crafting a reply and sending it back.

## Endianness
`Endianness` refers to the order in which a given multibyte data item is stored in memory
- `little Endian` store the most significant byte of data at the highest address
- `big endian` store the most significant byte of data at the lowest address
<div id="Network_Security_Wk_-_2_2023-09-18_1025.31.excalidraw.md3"></div><script>(function(){const InitialData={"type":"excalidraw","version":2,"source":"https://github.com/zsviczian/obsidian-excalidraw-plugin/releases/tag/1.9.19","elements":[{"id":"LBrsHmWZzjNEft1fEHOo0","type":"rectangle","x":-221.98828125,"y":-366.90625,"width":627.05078125,"height":78.0859375,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":1297001042,"version":242,"versionNonce":379605454,"isDeleted":false,"boundElements":null,"updated":1695007758542,"link":null,"locked":false},{"id":"i86EnL7l","type":"text","x":-203,"y":-345.77734375,"width":185.7998504638672,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":829849358,"version":27,"versionNonce":1604385298,"isDeleted":false,"boundElements":null,"updated":1695007758542,"link":null,"locked":false,"text":"store 0X87654321","rawText":"store 0X87654321","fontSize":20,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":18,"containerId":null,"originalText":"store 0X87654321","lineHeight":1.25},{"id":"d1FQ5VKHZnxO29Bb1An1Q","type":"rectangle","x":-198.25,"y":-226.28515625,"width":133.3515625,"height":377.6484375,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":1867628690,"version":163,"versionNonce":579921934,"isDeleted":false,"boundElements":null,"updated":1695007758542,"link":null,"locked":false},{"id":"HQC4z7-INSOlWARlUp6pQ","type":"rectangle","x":-37.765625,"y":-230.78906249999994,"width":127.85546875,"height":383.50781249999994,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":4326098,"version":287,"versionNonce":962324434,"isDeleted":false,"boundElements":null,"updated":1695007758542,"link":null,"locked":false},{"id":"aPPo4aDSVpYR1o35c76mE","type":"rectangle","x":-181.419921875,"y":-189.5234375,"width":102,"height":44,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":650717586,"version":151,"versionNonce":143963726,"isDeleted":false,"boundElements":[{"type":"text","id":"8OHUI3hM"}],"updated":1695007758542,"link":null,"locked":false},{"id":"8OHUI3hM","type":"text","x":-166.55990600585938,"y":-180.0234375,"width":72.27996826171875,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":1690789970,"version":8,"versionNonce":15932818,"isDeleted":false,"boundElements":null,"updated":1695007758542,"link":null,"locked":false,"text":"0X1003","rawText":"0X1003","fontSize":20,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":18,"containerId":"aPPo4aDSVpYR1o35c76mE","originalText":"0X1003","lineHeight":1.25},{"type":"rectangle","version":153,"versionNonce":293911694,"isDeleted":false,"id":"jRTbZbF4Duu7bha4eeNDV","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-179,"y":-102.77734375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":133494990,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"1a0bme__q0iWNFzKKt0u_"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":12,"versionNonce":1134402386,"isDeleted":false,"id":"kSkU1KjT","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-164.44998168945312,"y":-93.27734375,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":72.89996337890625,"height":25,"seed":1891151630,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1002","rawText":"0X1002","textAlign":"center","verticalAlign":"middle","containerId":"jRTbZbF4Duu7bha4eeNDV","originalText":"0X1002","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":304,"versionNonce":52034254,"isDeleted":false,"id":"8VMwwQ_Sm52XlzFqijTwT","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-179.6875,"y":-13.078125,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":679065614,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"TGzSg5qx"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":163,"versionNonce":1337090322,"isDeleted":false,"id":"TGzSg5qx","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-160.72748565673828,"y":-3.578125,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":64.07997131347656,"height":25,"seed":2028176974,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1001","rawText":"0X1001","textAlign":"center","verticalAlign":"middle","containerId":"8VMwwQ_Sm52XlzFqijTwT","originalText":"0X1001","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":265,"versionNonce":65892622,"isDeleted":false,"id":"_sXjqOCx0ExAlnNiYYBf6","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-176.18359375,"y":64.16796875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":552482958,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"cc9rOiFo"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":124,"versionNonce":279473874,"isDeleted":false,"id":"cc9rOiFo","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-161.3935775756836,"y":73.66796875,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":72.41996765136719,"height":25,"seed":1609823950,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1000","rawText":"0X1000","textAlign":"center","verticalAlign":"middle","containerId":"_sXjqOCx0ExAlnNiYYBf6","originalText":"0X1000","lineHeight":1.25,"baseline":18},{"id":"xXXR2g_21jMx9pRDFDBGD","type":"rectangle","x":-19.7734375,"y":64.541015625,"width":93,"height":40,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":817435150,"version":207,"versionNonce":2138578766,"isDeleted":false,"boundElements":[{"type":"text","id":"r3myBqhi"}],"updated":1695007758542,"link":null,"locked":false},{"id":"r3myBqhi","type":"text","x":16.896568298339844,"y":72.041015625,"width":19.659988403320312,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":1067129874,"version":4,"versionNonce":1796654226,"isDeleted":false,"boundElements":null,"updated":1695007758542,"link":null,"locked":false,"text":"21","rawText":"21","fontSize":20,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":18,"containerId":"xXXR2g_21jMx9pRDFDBGD","originalText":"21","lineHeight":1.25},{"type":"rectangle","version":221,"versionNonce":169018766,"isDeleted":false,"id":"bSMIVS7fxvZzpP9GZ41gj","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-21.4140625,"y":-9.77734375,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":814774286,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"FFZLeCOx"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":20,"versionNonce":414474834,"isDeleted":false,"id":"FFZLeCOx","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":11.875946044921875,"y":-2.27734375,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":26.41998291015625,"height":25,"seed":1344423502,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"43","rawText":"43","textAlign":"center","verticalAlign":"middle","containerId":"bSMIVS7fxvZzpP9GZ41gj","originalText":"43","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":291,"versionNonce":1157047246,"isDeleted":false,"id":"ISwr5wgwBUTxCAycdmvhJ","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-14.9921875,"y":-102.45703125,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":420401870,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"6v19h5Lg"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":90,"versionNonce":72894482,"isDeleted":false,"id":"6v19h5Lg","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":18.927825927734375,"y":-94.95703125,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":25.15997314453125,"height":25,"seed":898058510,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"65","rawText":"65","textAlign":"center","verticalAlign":"middle","containerId":"ISwr5wgwBUTxCAycdmvhJ","originalText":"65","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":236,"versionNonce":1111325198,"isDeleted":false,"id":"PKGuh5fb3lfH0KIjhZNFQ","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":-15.9296875,"y":-189.41796875,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":424834898,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"6ly2dESt"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":35,"versionNonce":637105618,"isDeleted":false,"id":"6ly2dESt","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":17.540321350097656,"y":-181.91796875,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":26.059982299804688,"height":25,"seed":1382792466,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"87","rawText":"87","textAlign":"center","verticalAlign":"middle","containerId":"PKGuh5fb3lfH0KIjhZNFQ","originalText":"87","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":328,"versionNonce":1759447118,"isDeleted":false,"id":"eiz5JTN1TkECCnDmo5Pif","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":112.220703125,"y":-233.82812500000006,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":133.3515625,"height":377.6484375,"seed":495898258,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1695007758542,"link":null,"locked":false},{"type":"rectangle","version":452,"versionNonce":1588521874,"isDeleted":false,"id":"7iZAu8VCnlLkBhn0V5oif","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":272.705078125,"y":-238.33203125000006,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":127.85546875,"height":383.50781249999994,"seed":328936530,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1695007758542,"link":null,"locked":false},{"type":"rectangle","version":316,"versionNonce":1488244366,"isDeleted":false,"id":"FHTyDCWOTAODAcf0cPJfQ","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":129.05078125,"y":-197.06640625000006,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":1272304146,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"A2lEf16Z"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":173,"versionNonce":1420798290,"isDeleted":false,"id":"A2lEf16Z","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":143.91079711914062,"y":-187.56640625000006,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":72.27996826171875,"height":25,"seed":2033565650,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1003","rawText":"0X1003","textAlign":"center","verticalAlign":"middle","containerId":"FHTyDCWOTAODAcf0cPJfQ","originalText":"0X1003","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":318,"versionNonce":1316474062,"isDeleted":false,"id":"7S3gfRJM3S4Uj_dS4nKNu","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":131.470703125,"y":-110.32031250000006,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":1473377682,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"KLP8KfOw"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":177,"versionNonce":1330818834,"isDeleted":false,"id":"KLP8KfOw","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":146.02072143554688,"y":-100.82031250000006,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":72.89996337890625,"height":25,"seed":148992850,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758542,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1002","rawText":"0X1002","textAlign":"center","verticalAlign":"middle","containerId":"7S3gfRJM3S4Uj_dS4nKNu","originalText":"0X1002","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":469,"versionNonce":130089742,"isDeleted":false,"id":"OohKoZ7SzXuCUrNxeM1wW","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":130.783203125,"y":-20.621093750000057,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":1857763602,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"n7OUK6aR"}],"updated":1695007758542,"link":null,"locked":false},{"type":"text","version":328,"versionNonce":319749330,"isDeleted":false,"id":"n7OUK6aR","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":149.74321746826172,"y":-11.121093750000057,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":64.07997131347656,"height":25,"seed":148260562,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1001","rawText":"0X1001","textAlign":"center","verticalAlign":"middle","containerId":"OohKoZ7SzXuCUrNxeM1wW","originalText":"0X1001","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":430,"versionNonce":654930254,"isDeleted":false,"id":"kTy98S_8LWsTI_dYln6Ju","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":134.287109375,"y":56.62499999999994,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":102,"height":44,"seed":1338612882,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"7Rm43J1z"}],"updated":1695007758543,"link":null,"locked":false},{"type":"text","version":289,"versionNonce":1031508626,"isDeleted":false,"id":"7Rm43J1z","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":149.0771255493164,"y":66.12499999999994,"strokeColor":"#1e1e1e","backgroundColor":"transparent","width":72.41996765136719,"height":25,"seed":290208338,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"0X1000","rawText":"0X1000","textAlign":"center","verticalAlign":"middle","containerId":"kTy98S_8LWsTI_dYln6Ju","originalText":"0X1000","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":527,"versionNonce":397023118,"isDeleted":false,"id":"QCz4qrXfhpqhaKQ_jX0fA","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":293.603515625,"y":-193.64648437500006,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":1278550034,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"UWiWboZs"}],"updated":1695007758543,"link":null,"locked":false},{"type":"text","version":324,"versionNonce":558854226,"isDeleted":false,"id":"UWiWboZs","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":330.27352142333984,"y":-186.14648437500006,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":19.659988403320312,"height":25,"seed":209407442,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"21","rawText":"21","textAlign":"center","verticalAlign":"middle","containerId":"QCz4qrXfhpqhaKQ_jX0fA","originalText":"21","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":533,"versionNonce":1910240718,"isDeleted":false,"id":"XyeKrxdLozytoWWfHyB_H","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":294.658203125,"y":-114.63281250000006,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":1194705810,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"GegZdVEd"}],"updated":1695007758543,"link":null,"locked":false},{"type":"text","version":332,"versionNonce":576820754,"isDeleted":false,"id":"GegZdVEd","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":327.9482116699219,"y":-107.13281250000006,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":26.41998291015625,"height":25,"seed":916160850,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"43","rawText":"43","textAlign":"center","verticalAlign":"middle","containerId":"XyeKrxdLozytoWWfHyB_H","originalText":"43","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":547,"versionNonce":1589120014,"isDeleted":false,"id":"ikgf4oULC1I1szRuhxKsg","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":293.201171875,"y":-19.023437500000057,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":906200850,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"uy5jGsHe"}],"updated":1695007758543,"link":null,"locked":false},{"type":"text","version":346,"versionNonce":296289234,"isDeleted":false,"id":"uy5jGsHe","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":327.1211853027344,"y":-11.523437500000057,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":25.15997314453125,"height":25,"seed":501535954,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"65","rawText":"65","textAlign":"center","verticalAlign":"middle","containerId":"ikgf4oULC1I1szRuhxKsg","originalText":"65","lineHeight":1.25,"baseline":18},{"type":"rectangle","version":554,"versionNonce":2084002382,"isDeleted":false,"id":"2tHfYfPlo52oS3lurUNaO","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":288.818359375,"y":62.02734374999994,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":93,"height":40,"seed":534145682,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"liHEI7Og"}],"updated":1695007758543,"link":null,"locked":false},{"type":"text","version":353,"versionNonce":154974610,"isDeleted":false,"id":"liHEI7Og","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":322.28836822509766,"y":69.52734374999994,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":26.059982299804688,"height":25,"seed":579815506,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"87","rawText":"87","textAlign":"center","verticalAlign":"middle","containerId":"2tHfYfPlo52oS3lurUNaO","originalText":"87","lineHeight":1.25,"baseline":18},{"id":"JSxfCIah3ut2xDZSkqbD5","type":"rectangle","x":-132.634765625,"y":189.11328125,"width":185,"height":78,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":84630290,"version":180,"versionNonce":1093853326,"isDeleted":false,"boundElements":[{"type":"text","id":"9W3vQu6f"}],"updated":1695007758543,"link":null,"locked":false},{"id":"9W3vQu6f","type":"text","x":-103.34471893310547,"y":215.61328125,"width":126.41990661621094,"height":25,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":266662546,"version":17,"versionNonce":1213445970,"isDeleted":false,"boundElements":null,"updated":1695007758543,"link":null,"locked":false,"text":"Little Endian","rawText":"Little Endian","fontSize":20,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":18,"containerId":"JSxfCIah3ut2xDZSkqbD5","originalText":"Little Endian","lineHeight":1.25},{"type":"rectangle","version":310,"versionNonce":1633918670,"isDeleted":false,"id":"B-yveciMij6DVhvCWKuYj","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":156.5234375,"y":182.96484375,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":185,"height":78,"seed":1967192338,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[{"type":"text","id":"Zxpq0Xq9"}],"updated":1695007758543,"link":null,"locked":false},{"type":"text","version":150,"versionNonce":256179474,"isDeleted":false,"id":"Zxpq0Xq9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":198.92346954345703,"y":209.46484375,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","width":100.19993591308594,"height":25,"seed":950273746,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1695007758543,"link":null,"locked":false,"fontSize":20,"fontFamily":1,"text":"Big Endian","rawText":"Big Endian","textAlign":"center","verticalAlign":"middle","containerId":"B-yveciMij6DVhvCWKuYj","originalText":"Big Endian","lineHeight":1.25,"baseline":18},{"id":"Loi74SMaOHEui6ChPPpMm","type":"line","x":101.91796875,"y":-270.37109374999994,"width":0.17578125,"height":559.45703125,"angle":0,"strokeColor":"#e03131","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":2},"seed":1672634514,"version":273,"versionNonce":1399579538,"isDeleted":false,"boundElements":null,"updated":1695007784774,"link":null,"locked":false,"points":[[0,0],[0.17578125,559.45703125]],"lastCommittedPoint":null,"startBinding":null,"endBinding":null,"startArrowhead":null,"endArrowhead":null},{"id":"pg_Efl8bXtkPZcL1MZVih","type":"line","x":93.1171875,"y":-276.14453125,"width":7.9765625,"height":544.1171875,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#ffc9c9","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":2},"seed":229558354,"version":82,"versionNonce":828544270,"isDeleted":true,"boundElements":null,"updated":1695007758543,"link":null,"locked":false,"points":[[0,0],[7.9765625,544.1171875]],"lastCommittedPoint":null,"startBinding":null,"endBinding":null,"startArrowhead":null,"endArrowhead":null}],"appState":{"theme":"light","viewBackgroundColor":"#ffffff","currentItemStrokeColor":"#e03131","currentItemBackgroundColor":"#ffc9c9","currentItemFillStyle":"hachure","currentItemStrokeWidth":1,"currentItemStrokeStyle":"solid","currentItemRoughness":1,"currentItemOpacity":100,"currentItemFontFamily":1,"currentItemFontSize":20,"currentItemTextAlign":"left","currentItemStartArrowhead":null,"currentItemEndArrowhead":"arrow","scrollX":314,"scrollY":440.22265625,"zoom":{"value":1},"currentItemRoundness":"round","gridSize":null,"gridColor":{"Bold":"#C9C9C9FF","Regular":"#EDEDEDFF"},"currentStrokeOptions":null,"previousGridSize":null,"frameRendering":{"enabled":true,"clip":true,"name":true,"outline":true}},"files":{}};InitialData.scrollToContent=true;App=()=>{const e=React.useRef(null),t=React.useRef(null),[n,i]=React.useState({width:void 0,height:void 0});return React.useEffect(()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height});const e=()=>{i({width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]),React.createElement(React.Fragment,null,React.createElement("div",{className:"excalidraw-wrapper",ref:t},React.createElement(ExcalidrawLib.Excalidraw,{ref:e,width:n.width,height:n.height,initialData:InitialData,viewModeEnabled:!0,zenModeEnabled:!0,gridModeEnabled:!1})))},excalidrawWrapper=document.getElementById("Network_Security_Wk_-_2_2023-09-18_1025.31.excalidraw.md3");ReactDOM.render(React.createElement(App),excalidrawWrapper);})();</script>

# Packet sniffing and spoofing lab
The lab is carried under guidance of seed lab to have better understanding of how packet sniffing and spoofing is done in a local network. The result of the lab can be found in [[Study/50.020 Network Security/3.1Packet Sniffing and Spoofing\|3.1Packet Sniffing and Spoofing]]